<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the AAL atlas â€¢ aal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the AAL atlas">
<meta property="og:description" content="aal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using_aal.html">Using the AAL atlas</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muschellij2/aal/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="using_aal_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the AAL atlas</h1>
                        <h4 data-toc-skip class="author">John Muschelli</h4>
            
            <h4 data-toc-skip class="date">2021-05-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/muschellij2/aal/blob/master/vignettes/using_aal.Rmd" class="external-link"><code>vignettes/using_aal.Rmd</code></a></small>
      <div class="hidden name"><code>using_aal.Rmd</code></div>

    </div>

    
    
<div id="read-in-the-mni-template" class="section level1">
<h1 class="hasAnchor">
<a href="#read-in-the-mni-template" class="anchor" aria-hidden="true"></a>Read in the MNI Template</h1>
<p>The AAL atlas is labeled in MNI space. In order to overlay on an image, we will read in the MNI template. Note, we need the 2mm image as the AAL is in that dimensions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/muschellij2/aal" class="external-link">aal</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">neurobase</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: oro.nifti</span>
<span class="co">#&gt; oro.nifti 0.11.0</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Jfortin1/MNITemplate" class="external-link">MNITemplate</a></span><span class="op">)</span>

<span class="va">img</span> <span class="op">=</span> <span class="fu">MNITemplate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MNITemplate/man/readMNI.html" class="external-link">readMNI</a></span><span class="op">(</span>res <span class="op">=</span> <span class="st">'2mm'</span><span class="op">)</span></code></pre></div>
<p>Here we will show how to use the borders of the ROIs with the <code>aal_labels</code> data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mask</span> <span class="op">=</span> <span class="va">img</span> <span class="op">*</span> <span class="fl">0</span>

<span class="va">labs</span> <span class="op">=</span> <span class="fu"><a href="../reference/aal_labels.html">aal_get_labels</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>
<span class="va">labs</span><span class="op">$</span><span class="va">color</span> <span class="op">=</span> <span class="va">aal_colors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">labs</span><span class="op">)</span><span class="op">]</span>

<span class="va">tri</span> <span class="op">=</span> <span class="fu"><a href="../reference/aal_border.html">aal_get_border</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span>
<span class="va">tri_labs</span> <span class="op">=</span> <span class="va">tri</span><span class="op">$</span><span class="va">BORDER.V</span>
<span class="va">tri_labs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  index <span class="op">=</span> <span class="va">tri_labs</span>,
  order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tri_labs</span><span class="op">)</span><span class="op">)</span> 
<span class="va">tri_labs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">tri_labs</span>, <span class="va">labs</span>, by <span class="op">=</span> <span class="st">"index"</span>, 
        all.x <span class="op">=</span> <span class="cn">TRUE</span>, all.y <span class="op">=</span> <span class="cn">FALSE</span>,
        sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tri_labs</span> <span class="op">=</span> <span class="va">tri_labs</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tri_labs</span><span class="op">$</span><span class="va">order</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">tri_labs</span><span class="op">$</span><span class="va">order</span> <span class="op">=</span> <span class="cn">NULL</span>
<span class="va">tri_labs</span><span class="op">$</span><span class="va">relabel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">tri_labs</span><span class="op">$</span><span class="va">index</span>,
                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tri_labs</span><span class="op">$</span><span class="va">index</span><span class="op">)</span><span class="op">)</span>
<span class="co"># save this for later</span>
<span class="va">relabeled_fac</span> <span class="op">=</span> <span class="va">tri_labs</span><span class="op">$</span><span class="va">relabel</span>
<span class="va">tri_labs</span><span class="op">$</span><span class="va">relabel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tri_labs</span><span class="op">$</span><span class="va">relabel</span><span class="op">)</span>

<span class="va">tri</span> <span class="op">=</span> <span class="va">tri</span><span class="op">$</span><span class="va">BORDER.XYZ</span>

<span class="va">cols</span> <span class="op">=</span> <span class="va">tri_labs</span><span class="op">$</span><span class="va">color</span>
<span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span>
<span class="va">mask</span><span class="op">[</span><span class="va">tri</span><span class="op">]</span> <span class="op">=</span> <span class="va">tri_labs</span><span class="op">$</span><span class="va">relabel</span>
<span class="fu">neurobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neurobase/man/ortho2.html" class="external-link">ortho2</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">mask</span>, col.y <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></code></pre></div>
<p><img src="using_aal_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Here we will read in the full atlas and plot it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atlas</span> <span class="op">=</span> <span class="fu"><a href="../reference/aal_fname.html">aal_image</a></span><span class="op">(</span>version <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu">neurobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neurobase/man/ortho2.html" class="external-link">ortho2</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">atlas</span>, col.y <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></code></pre></div>
<p><img src="using_aal_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>In order to try to keep the colors consistent as with the borders, we will have to refactor the values of the image:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relabeled_atlas</span> <span class="op">=</span> <span class="va">atlas</span><span class="op">[</span> <span class="va">atlas</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">]</span>
<span class="va">relabeled_atlas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">relabeled_atlas</span>,
                                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">relabeled_fac</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">relabeled_atlas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/neurobase/man/remake_img.html" class="external-link">remake_img</a></span><span class="op">(</span><span class="va">relabeled_atlas</span>, img <span class="op">=</span> <span class="va">atlas</span>, mask <span class="op">=</span> <span class="va">atlas</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu">neurobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neurobase/man/ortho2.html" class="external-link">ortho2</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">relabeled_atlas</span>, col.y <span class="op">=</span> <span class="va">cols</span><span class="op">)</span></code></pre></div>
<p><img src="using_aal_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Muschelli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
